@namespace TobyBlazor.Components

@using TobyBlazor.Data
@using TobyBlazor.Models
@using System.Linq

@inject IJSRuntime jsRuntime

<input type="text" class="form-control" id="commandInput" placeholder="Search..."
       @onchange=@(newValue => CommandChanged(newValue.Value.ToString()))
       onchange-prevent-default />

@code {
    [Parameter]
    public EventCallback<List<Video>> OnSearch { get; set; }

    private readonly IVideoRepository videos = new VideoRepository();

    public List<Video> SearchResults = new List<Video>();

    private async void CommandChanged(string term)
    {
        await OnSearch.InvokeAsync(videos.Search(term));
    }
}
